{
  "behaviorName": "shape",
  "instructions": [
    "CRITICAL: For the shape behavior, you MUST ask the user these questions and wait for their explicit answers. DO NOT infer, assume, or proceed without user responses.",
    "",
    "**MANDATORY WORKFLOW - THIS STEP CAN NEVER BE SKIPPED:**",
    "",
    "**STEP 0: EXAMINE INITIAL CONTEXT AND REQUIREMENTS**",
    "Before asking questions, you MUST thoroughly examine all context passed in:",
    "1. **Review Initial Request:** Understand what they asked for, what problem they're solving, and desired outcome",
    "2. **Examine Provided Evidence:** Review documents, requirements, and context files for problem type, complexity, scope, and constraints",
    "3. **Identify Context Patterns:** Look for problem nature (new system/integration/workflow/domain modeling), complexity signals (user types, journeys, integrations), value drivers (customer experience, efficiency, compliance, revenue), and pain points (struggles, inefficiencies, workarounds)",
    "",
    "**STEP 1: ASK KEY QUESTIONS**",
    "1. Present each required question to the user clearly and explicitly in the chat window",
    "2. Tailor question emphasis based on initial context analysis - focus deeper on areas that seem critical",
    "3. Wait for the user to answer each question",
    "",
    "**STEP 2: MANDATORY PRESENTATION STEP - NEVER SKIP**",
    "After receiving answers, you MUST present in the chat window:",
    "   - **Questions Asked:** List each question you asked the user",
    "   - **Answers Provided:** Show the exact answers the user provided for each question",
    "   - **Gap Analysis:** A focused analysis highlighting where questions were NOT properly answered or need more detail",
    "   - **Request for Corrections:** Explicitly ask the user to review and provide corrections or additional detail",
    "",
    "**STEP 3: REFINEMENT AND VALIDATION**",
    "3. Be PESSIMISTIC and CONSERVATIVE - if an answer seems incomplete, vague, or could be interpreted multiple ways, you MUST ask for clarification",
    "4. There is NEVER too much detail at this stage - it is EXTREMELY IMPORTANT to stop and get complete answers",
    "",
    "**STEP 4: MANDATORY STORAGE STEP**",
    "After user confirms all answers are complete, you MUST pass `key_questions_answered` and `evidence_provided` as parameters to the behavior action tool:",
    "   - Pass parameters to the behavior action tool (e.g., `mcp_story-bot_shape` with action `clarify`):",
    "     * `key_questions_answered`: dict mapping question keys to answer strings",
    "     * `evidence_provided`: dict mapping evidence types to evidence content",
    "   - Example: key_questions_answered={'user_types': 'Game Masters', 'first_action': 'Group tokens into mobs'}",
    "   - The action will automatically save to `{project_area}/docs/stories/clarification.json`",
    "",
    "**STEP 5: PROCEED TO PLANNING**",
    "5. DO NOT proceed to planning until:",
    "   - You have examined initial context and requirements",
    "   - You have presented questions and answers in the chat window",
    "   - The user has reviewed and confirmed or corrected the answers",
    "   - ALL questions have complete, unambiguous answers confirmed by the user",
    "   - You have successfully stored the clarification data by passing parameters to the action tool",
    "",
    "**CRITICAL REMINDER:** The presentation of questions and answers in the chat window is MANDATORY and CANNOT BE SKIPPED. This allows the user to see what was asked, how it was answered, and provide corrections. For shape behavior specifically, incomplete clarification will lead to poor story maps. Stop and get complete answers."
  ]
}

